# Rendering Time

## Initialization Process Duration

Before a Lynx page is displayed, initialization tasks must be completed, including container initialization and preparing the [TemplateBundle](/api/lynx-native-api/template-bundle).

The diagram below shows the mandatory initialization phases before page display, covering initialization duration for three components: [Container](/guide/spec#container), [LynxView](/guide/spec#lynxviewâ‘ ), and [Background Thread Runtime](/guide/spec#background-thread-runtime). The [Performance API](/guide/performance/metrics/performance-api) provides [`InitContainerEntry`](/api/lynx-api/performance-api/performance-entry/init-container-entry), [`InitLynxviewEntry`](/api/lynx-api/performance-api/performance-entry/init-lynxview-entry), and [`InitBackgroundRuntimeEntry`](/api/lynx-api/performance-api/performance-entry/init-background-runtime-entry) to describe key milestones in these phases. You can combine these performance metrics for detailed analysis of the entire initialization process.

![Complete Initialization Phase Breakdown](https://lf-lynx.tiktok-cdns.com/obj/lynx-artifacts-oss-sg/lynx-website/assets/doc/all-init-process.png 'Complete Initialization Phase Breakdown')

Even though these preparations occur before page rendering, their performance directly impacts user experience. Slow initialization delays rendering, causing users to perceive poor app performance due to delayed content display.

To minimize loading time, pre-complete initialization tasks through local caching, pre-loading TemplateBundles, and pre-creating LynxViews. This ensures immediate response to user interactions and enhances user experience.

## First-Frame Rendering Duration

Lynx's unique dual-thread architecture allows rendering operations in the main thread runtime. This enables Instant First-Frame Rendering (IFR): Lynx briefly blocks the main thread to ensure the first frame renders completely at once. Since users see no blank screen, this creates a perception of instant responsiveness.

Read [First-Frame Rendering Best Practices]() to learn how to render meaningful content in the first frame.

Obtain [`LoadBundleEntry`](/api/lynx-api/performance-api/performance-entry/load-bundle-entry) for detailed timing data of first-frame rendering.

## Non-First-Frame Rendering Duration

Many pages can only display loading animations or skeleton screens in the first frame. Critical data from native modules or network requests is required to complete page display. In such scenarios, developers need the duration of rendering triggered by critical data updates.

Developers can [mark the Lynx pipeline](/guide/performance/metrics/timing-flag) to track these important updates. After marking, detailed timing data for the marked [Lynx Pipeline](/guide/spec#lynx-pipeline) can be obtained. The rendering duration for this update is available via the [`PipelineEntry`](/api/lynx-api/performance-api/performance-entry/pipeline-entry) interface.

## Built-in Metrics

Lynx provides two built-in metrics: FCP and ActualFMP, with corresponding data available through MetricFcpEntry and MetricActualFmpEntry.

### FCP (First Contentful Paint)

FCP is a critical performance metric measuring the time until the first content (text, images, etc.) renders in a Lynx page. The FCP event triggers when Lynx finishes painting the first frame.

Lynx offers three FCP variants based on different starting points: `fcp`, `lynxFcp`, and `totalFcp`. Their definitions in the rendering flow are shown below:

<img src="https://lf-lynx.tiktok-cdns.com/obj/lynx-artifacts-oss-sg/lynx-website/assets/doc/metric-fcp-entry.png" />

### ActualFMP (Actual First Meaningful Paint)

ActualFMP measures the time until "real data" renders on the page, reflecting how quickly users see actual content. `MetricActualFmpEntry` describes this metric and inherits from [`PerformanceEntry`](/api/lynx-api/performance-api/performance-entry).

Mark critical component rendering completion using [`__lynx_timing_flag="__lynx_timing_actual_fmp"`](/guide/performance/metrics/timing-flag) to generate this metric.

<img src="https://lf-lynx.tiktok-cdns.com/obj/lynx-artifacts-oss-sg/lynx-website/assets/doc/performance-metrics-actual-fmp.png" />

Lynx provides three ActualFMP variants: `actualFmp`, `lynxActualFmp`, and `totalActualFmp`. Their definitions are shown below:

<img src="https://lf-lynx.tiktok-cdns.com/obj/lynx-artifacts-oss-sg/lynx-website/assets/doc/metric-actual-fmp-entry.png" />

## Custom Metrics

Custom performance metrics align with specific business objectives. Usage of the [Performance API](/guide/performance/metrics/performance-api) is not restricted to analyzing
page performance using built-in metrics. You can flexibly combine key moments of different [`PerformanceEntry`](/api/lynx-api/performance-api/performance-entry) to build a set
of performance metrics tailored to your application.

For example, if you want to focus on the delay between the end of the first-frame rendering and the end of the first significant data updates. You can combine
[`LoadBundleEntry`](/api/lynx-api/performance-api/performance-entry/load-bundle-entry) and [`PipelineEntry`](/api/lynx-api/performance-api/performance-entry/pipeline-entry)
to calculate a new performance metric `waitingDuration` like the following code. This metric can help you monitor the speed of network requests, file reads, and other
behaviors, pinpointing the reasons for deteriorating page performance.

![waiting duration](https://lf-lynx.tiktok-cdns.com/obj/lynx-artifacts-oss-sg/lynx-website/assets/doc/custom-metric-waitingduration.png)

import { Go } from '@lynx';

<Go
  example="performance-api"
  defaultFile="src/create-custom-metric/index.tsx"
  img="https://lf-lynx.tiktok-cdns.com/obj/lynx-artifacts-oss-sg/lynx-website/assets/doc/create-custom-performance-metric.jpeg"
  highlight="{18-40}"
  entry="src/create-custom-metric"
/>
