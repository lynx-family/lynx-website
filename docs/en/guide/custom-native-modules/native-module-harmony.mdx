import { Steps, Tabs, Tab, PackageManagerTabs } from '@theme'
import { CodeFold } from '@lynx'

First, follow the [Build Lynx Explorer for HarmonyOS](https://github.com/lynx-family/lynx/tree/develop/explorer/harmony) guide to create a Lynx Explorer project locally.

Next, create a new `NativeLocalStorageModule.ets` file in the Lynx Explorer project and inherit from `LynxModule` in the `@lynx/lynx` package to implement the `NativeLocalStorageModule` native module.

:::info
You can add the `@Sendable` annotation to the Module class to convert it into a Sendable Module. Only the methods of a Sendable Module are synchronous; all other methods are asynchronous. The return value of an asynchronous method is `null`.
:::

<CodeFold height={360} toggle>

```typescript title="NativeLocalStorageModule.ets"
import { LynxModule } from '@lynx/lynx';
import Constants from '../common/constants';
import { featureAbility } from '@kit.AbilityKit';
import { preferences } from '@kit.ArkData';

export class NativeLocalStorageModule {
  private static readonly PREF_NAME: string = "MyLocalStorage";
  private context: any;
  private dataPreferences: preferences.Preferences | null = null;

  constructor(context: any) {
    this.context = context;
    this.initPreferencesSync();
  }

  private initPreferencesSync() {
    try {
      this.dataPreferences = preferences.getPreferencesSync(
        this.getContext(), 
        { name: NativeLocalStorageModule.PREF_NAME }
      );
      console.info("Preferences initialization succeeded.");
    } catch (error) {
      console.error(`Failed to initialize preferences: ${error}`);
    }
  }

  private getContext(): any {
    return featureAbility.getContext();
  }

  public setStorageItem(key: string, value: string) {
    if (!this.dataPreferences) {
      console.error("Preferences instance is not initialized.");
      return;
    }

    try {
      this.dataPreferences.putSync(key, value);
      this.dataPreferences.flushSync();
      console.info(`Storage item set successfully. key=${key}`);
    } catch (err: any) {
      console.error(`Failed to set storage item. key=${key}, error=${err.message}`);
    }
  }

  public getStorageItem(key: string, callback: (value: string)=> void) {
    if (!this.dataPreferences) {
      console.error("Preferences instance is not initialized.");
      callback("");
      return;
    }

    try {
      const value = this.dataPreferences.getSync(key, "");
      callback(value as string);
      return;
    } catch (err) {
      console.error(`Failed to get storage item. key=${key}, error=${err.message}`);
      callback("");
      return;
    }
  }

  public clearStorage() {
    if (!this.dataPreferences) {
      console.error("Preferences instance is not initialized.");
      return;
    }

    try {
      this.dataPreferences.clearSync();
      this.dataPreferences.flushSync();
      console.info("Storage cleared successfully.");
    } catch (err: any) {
      console.error(`Failed to clear storage. error=${err.message}`);
    }
  }
}

```

</CodeFold>

Next, register the native module with the Lynx runtime environment.

In the aboutToAppear method of the explorer/harmony/lynx_explorer/src/main/ets/pages/Lynx.ets file in your Lynx Explorer project, add the following registration code to register the native module with the Lynx runtime environment. Here, you need to specify the name of the native module, which must be consistent with the name in the interface specification above.

:::info
Register a regular Module in `this.modules` , and a Sendable Module in `this.sendableModules` .
:::

```typescript {8-10,12} title="src/main/ets/pages/Lynx.ets"
import { NativeLocalStorageModule } from '../module/NativeLocalStorageModule';

@Entry
@Component
struct Lynx {
  aboutToAppear() {
    // `param` is an optional constructor parameter for the module
    this.modules.set('NativeLocalStorageModule', {
      moduleClass: NativeLocalStorageModule,
      param: {}
    });
    // Register Sendable Modules to this.sendableModules
  }
}
```

Once you've prepared everything, you can now build and run your code.

First, follow the [Build and Run iOS Lynx Explorer](https://github.com/lynx-family/lynx/tree/develop/explorer/darwin/harmony) guide to build Lynx Explorer and install it on your phone.

Next, refer to the [Install Dependencies & Start the Development Server](../start/quick-start#Installation) guide to install dependencies and start the development server in the root directory of your Lynx project.

Install dependencies:

<PackageManagerTabs command="install" />

Start the development server:

<PackageManagerTabs command="run dev" />

You'll see a QR code and an artifact link in the console. Use Lynx Explorer to scan the QR code or enter the artifact link to open your Lynx page.

![demo](https://lf-lynx.tiktok-cdns.com/obj/lynx-artifacts-oss-sg/plugin/static/native-modules-demo-harmony-0.gif)
